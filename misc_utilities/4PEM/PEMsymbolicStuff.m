syms x1 x2 x3 x4 y1 y2 y3 y4 w
M1 = [1 0 0 0 ; 0 1 0 0 ; 0 0 y1 -x1 ; 0 0 x1 y1];
M4 = [1 0 0 0 ; 0 1 0 0 ; 0 0 y4 -x4 ; 0 0 x4 y4];
M2 = [1 0 0 0 ; 0 y2 0 x2 ; 0 0 1 0 ; 0 -x2 0 y2];
M3 = [1 0 0 0 ; 0 y3 0 x3 ; 0 0 1 0 ; 0 -x3 0 y3];
p1 = [1 0 1 0 ; 0 0 0 0 ; 1 0 1 0 ; 0 0 0 0];
p2 = [1 0 -1 0 ; 0 0 0 0 ; -1 0 1 0 ; 0 0 0 0];
%R = @(w) [1 0 0 0 ; 0 cos(2*w) sin(2*w) 0 ; 0 -sin(2*w) cos(2*w) 0 ; 0 0 0 1];
R = [1 0 0 0 ; 0 0 1 0 ; 0 1 0 0 ; 0 0 0 1];
no_ers = expand([1,0,0,0]*p2*M4*M3*M2*M1*p1*[1;0;0;0])
m1_p1 = expand([1,0,0,0]*p2*M4*M3*M2*M1*R*p1*R*[1;0;0;0])
m2_m1 = expand([1,0,0,0]*p2*M4*M3*M2*R*M1*p1*R*[1;0;0;0])
m3_m2 = expand([1,0,0,0]*p2*M4*M3*R*M2*M1*p1*R*[1;0;0;0])
m4_m3 = expand([1,0,0,0]*p2*M4*R*M3*M2*M1*p1*R*[1;0;0;0])
p2_m4 = expand([1,0,0,0]*p2*R*M4*M3*M2*M1*p1*R*[1;0;0;0])
